<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Threat Detection Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .metric-card {
            text-align: center;
            padding: 15px;
        }
        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
        }
        .metric-label {
            color: #6c757d;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">Cybersecurity Threat Detection Dashboard</span>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Overview Metrics -->
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="metric-value">282</div>
                    <div class="metric-label">Total Attacks Detected</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="metric-value">100%</div>
                    <div class="metric-label">WAF Rule Triggers</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="metric-value">7</div>
                    <div class="metric-label">Source Countries</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card">
                    <div class="metric-value">443</div>
                    <div class="metric-label">Top Destination Port</div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <!-- Main Visualization Area -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <ul class="nav nav-tabs card-header-tabs">
                            <li class="nav-item">
                                <a class="nav-link active" href="#" id="network-tab">Network Graph</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="timeseries-tab">Time Series</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="geo-tab">Geographic View</a>
                            </li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <div id="main-visualization" style="height: 500px;">
                            <!-- Plotly visualization will go here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Attack Details -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        Attack Details
                    </div>
                    <div class="card-body">
                        <div id="attack-details">
                            <h5>Top Attack Types</h5>
                            <div id="attack-types-chart" style="height: 200px;"></div>
                            
                            <h5 class="mt-4">Protocol Distribution</h5>
                            <div id="protocol-chart" style="height: 200px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <!-- Model Performance -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        Machine Learning Model Performance
                    </div>
                    <div class="card-body">
                        <div id="model-metrics">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Model</th>
                                        <th>Accuracy</th>
                                        <th>Precision</th>
                                        <th>Recall</th>
                                        <th>F1-Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Random Forest</td>
                                        <td>0.95</td>
                                        <td>0.94</td>
                                        <td>0.96</td>
                                        <td>0.95</td>
                                    </tr>
                                    <tr>
                                        <td>CNN</td>
                                        <td>0.97</td>
                                        <td>0.96</td>
                                        <td>0.98</td>
                                        <td>0.97</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div id="feature-importance-chart" style="height: 300px;"></div>
                    </div>
                </div>
            </div>

            <!-- Raw Data Sample -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        Recent Threat Alerts
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm table-hover">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Source IP</th>
                                        <th>Country</th>
                                        <th>Bytes In</th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>2024-04-25 23:00:00</td>
                                        <td>147.161.161.82</td>
                                        <td>AE</td>
                                        <td>5602</td>
                                        <td>Suspicious Web Traffic</td>
                                    </tr>
                                    <tr>
                                        <td>2024-04-25 23:00:00</td>
                                        <td>165.225.33.6</td>
                                        <td>US</td>
                                        <td>30912</td>
                                        <td>Suspicious Web Traffic</td>
                                    </tr>
                                    <tr>
                                        <td>2024-04-25 23:00:00</td>
                                        <td>165.225.212.255</td>
                                        <td>CA</td>
                                        <td>28506</td>
                                        <td>Suspicious Web Traffic</td>
                                    </tr>
                                    <tr>
                                        <td>2024-04-25 23:00:00</td>
                                        <td>136.226.64.114</td>
                                        <td>US</td>
                                        <td>30546</td>
                                        <td>Suspicious Web Traffic</td>
                                    </tr>
                                    <tr>
                                        <td>2024-04-25 23:00:00</td>
                                        <td>165.225.240.79</td>
                                        <td>NL</td>
                                        <td>6526</td>
                                        <td>Suspicious Web Traffic</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample Plotly visualization for the dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Network graph visualization
            const networkData = {
                nodes: [
                    {id: '147.161.161.82', group: 1, country: 'AE', size: 10},
                    {id: '165.225.33.6', group: 1, country: 'US', size: 15},
                    {id: '165.225.212.255', group: 1, country: 'CA', size: 12},
                    {id: '136.226.64.114', group: 1, country: 'US', size: 14},
                    {id: '165.225.240.79', group: 1, country: 'NL', size: 8},
                    {id: '10.138.69.97', group: 2, size: 20}
                ],
                links: [
                    {source: '147.161.161.82', target: '10.138.69.97', value: 5602},
                    {source: '165.225.33.6', target: '10.138.69.97', value: 30912},
                    {source: '165.225.212.255', target: '10.138.69.97', value: 28506},
                    {source: '136.226.64.114', target: '10.138.69.97', value: 30546},
                    {source: '165.225.240.79', target: '10.138.69.97', value: 6526}
                ]
            };

            const networkGraph = {
                nodes: networkData.nodes.map(node => ({
                    ...node,
                    color: node.country ? 
                        ['#FF5733', '#33FF57', '#3357FF', '#F3FF33', '#FF33F5'][node.group] : '#888'
                })),
                links: networkData.links
            };

            Plotly.newPlot('main-visualization', [{
                type: 'sankey',
                orientation: 'h',
                node: {
                    pad: 15,
                    thickness: 30,
                    line: {
                        color: 'black',
                        width: 0.5
                    },
                    label: networkGraph.nodes.map(node => node.id),
                    color: networkGraph.nodes.map(node => node.color)
                },
                link: {
                    source: networkGraph.links.map(link => networkGraph.nodes.findIndex(node => node.id === link.source)),
                    target: networkGraph.links.map(link => networkGraph.nodes.findIndex(node => node.id === link.target)),
                    value: networkGraph.links.map(link => link.value),
                    color: networkGraph.links.map(link => {
                        const sourceNode = networkGraph.nodes.find(node => node.id === link.source);
                        return sourceNode.color.replace('0.8', '0.3');
                    })
                }
            }], {
                title: 'Network Traffic Connections',
                height: 500
            });

            // Attack types pie chart
            Plotly.newPlot('attack-types-chart', [{
                values: [282],
                labels: ['Suspicious Web Traffic'],
                type: 'pie',
                marker: {
                    colors: ['#FF5733']
                }
            }], {
                height: 200,
                showlegend: false,
                margin: {t: 0, b: 0, l: 0, r: 0}
            });

            // Protocol distribution
            Plotly.newPlot('protocol-chart', [{
                values: [282],
                labels: ['HTTPS'],
                type: 'pie',
                marker: {
                    colors: ['#33FF57']
                }
            }], {
                height: 200,
                showlegend: false,
                margin: {t: 0, b: 0, l: 0, r: 0}
            });

            // Feature importance
            const featureImportance = {
                features: ['bytes_in', 'bytes_out', 'duration_seconds', 'src_ip_country_code_US', 'src_ip_country_code_CA'],
                importance: [0.32, 0.33, 0.05, 0.20, 0.10]
            };

            Plotly.newPlot('feature-importance-chart', [{
                type: 'bar',
                x: featureImportance.importance,
                y: featureImportance.features,
                orientation: 'h'
            }], {
                title: 'Feature Importance (Random Forest)',
                xaxis: {title: 'Importance Score'},
                margin: {l: 150}
            });

            // Tab switching functionality
            document.getElementById('timeseries-tab').addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active tab
                document.querySelector('.nav-link.active').classList.remove('active');
                this.classList.add('active');
                
                // Update visualization
                const timeData = {
                    time: ['2024-04-25 23:00', '2024-04-25 23:10', '2024-04-25 23:20', '2024-04-25 23:30'],
                    attacks: [5, 12, 8, 15]
                };

                Plotly.newPlot('main-visualization', [{
                    x: timeData.time,
                    y: timeData.attacks,
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: {color: '#FF5733'}
                }], {
                    title: 'Attack Frequency Over Time',
                    xaxis: {title: 'Time'},
                    yaxis: {title: 'Number of Attacks'},
                    height: 500
                });
            });

            document.getElementById('network-tab').addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active tab
                document.querySelector('.nav-link.active').classList.remove('active');
                this.classList.add('active');
                
                // Replot the original network graph
                Plotly.newPlot('main-visualization', [{
                    type: 'sankey',
                    orientation: 'h',
                    node: {
                        pad: 15,
                        thickness: 30,
                        line: {
                            color: 'black',
                            width: 0.5
                        },
                        label: networkGraph.nodes.map(node => node.id),
                        color: networkGraph.nodes.map(node => node.color)
                    },
                    link: {
                        source: networkGraph.links.map(link => networkGraph.nodes.findIndex(node => node.id === link.source)),
                        target: networkGraph.links.map(link => networkGraph.nodes.findIndex(node => node.id === link.target)),
                        value: networkGraph.links.map(link => link.value),
                        color: networkGraph.links.map(link => {
                            const sourceNode = networkGraph.nodes.find(node => node.id === link.source);
                            return sourceNode.color.replace('0.8', '0.3');
                        })
                    }
                }], {
                    title: 'Network Traffic Connections',
                    height: 500
                });
            });

            document.getElementById('geo-tab').addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active tab
                document.querySelector('.nav-link.active').classList.remove('active');
                this.classList.add('active');
                
                // Geographic visualization
                const geoData = {
                    countries: ['US', 'CA', 'AE', 'NL', 'DE', 'IL', 'AT'],
                    attacks: [120, 85, 45, 15, 10, 5, 2]
                };

                Plotly.newPlot('main-visualization', [{
                    type: 'choropleth',
                    locationmode: 'country names',
                    locations: geoData.countries,
                    z: geoData.attacks,
                    text: geoData.countries,
                    colorscale: 'Reds',
                    autocolorscale: false,
                    reversescale: false,
                    marker: {
                        line: {
                            color: 'rgb(180,180,180)',
                            width: 0.5
                        }
                    },
                    colorbar: {
                        title: 'Number of Attacks'
                    }
                }], {
                    title: 'Attack Origins by Country',
                    geo: {
                        showframe: false,
                        showcoastlines: false,
                        projection: {
                            type: 'mercator'
                        }
                    },
                    height: 500
                });
            });
        });
    </script>
</body>
</html>
